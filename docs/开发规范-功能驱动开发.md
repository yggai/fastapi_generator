# FastAPIè‡ªåŠ¨åŒ–å¼€å‘è§„èŒƒ v2.0

**ä½œè€…**: æºæ»šæ»šAIç¼–ç¨‹  
**åˆ›å»ºæ—¶é—´**: 2025å¹´7æœˆ10æ—¥  
**é€‚ç”¨èŒƒå›´**: æ‰€æœ‰FastAPI/Pythoné¡¹ç›®  
**æ ¸å¿ƒç†å¿µ**: è‡ªåŠ¨åŒ–ä¼˜å…ˆï¼ŒåŠŸèƒ½é©±åŠ¨ï¼Œæ•ˆç‡è‡³ä¸Š

---

## ğŸš€ è‡ªåŠ¨åŒ–å¼€å‘æ ¸å¿ƒç†å¿µ

### æ ¸å¿ƒåŸåˆ™

1. **è‡ªåŠ¨åŒ–ä¼˜å…ˆ** - æ‰€æœ‰é‡å¤æ€§å·¥ä½œå¿…é¡»è‡ªåŠ¨åŒ–
2. **ä¸€é”®ç”Ÿæˆ** - æ–°åŠŸèƒ½å¼€å‘å¿…é¡»é€šè¿‡è„šæœ¬ä¸€é”®ç”Ÿæˆ
3. **é›¶æ‰‹åŠ¨æ“ä½œ** - é¿å…ä»»ä½•æ‰‹åŠ¨åˆ›å»ºæ–‡ä»¶ã€æ›´æ–°æ–‡æ¡£çš„æ“ä½œ
4. **å·¥å…·é“¾é©±åŠ¨** - å¼€å‘æµç¨‹å®Œå…¨ç”±å·¥å…·é“¾é©±åŠ¨
5. **æ•ˆç‡è‡³ä¸Š** - å¼€å‘é€Ÿåº¦ä¼˜å…ˆäºå®Œç¾ä¸»ä¹‰
6. **æ ‡å‡†åŒ–è¾“å‡º** - ç¡®ä¿ç”Ÿæˆä»£ç çš„æ ‡å‡†åŒ–å’Œä¸€è‡´æ€§
7. **å¿«é€Ÿå¯åŠ¨** - ä¸“æ³¨äºé¡¹ç›®å¿«é€Ÿå¯åŠ¨ä½“éªŒ
8. **å‘½ä»¤è¡Œä¼˜å…ˆ** - æ‰€æœ‰æ“ä½œé€šè¿‡å‘½ä»¤è¡Œå·¥å…·å®Œæˆ

### è‡ªåŠ¨åŒ–å¼€å‘ç›®æ ‡

| ä¼ ç»Ÿå¼€å‘ | è‡ªåŠ¨åŒ–å¼€å‘ | æ•ˆç‡æå‡ |
|---------|-----------|---------|
| æ‰‹åŠ¨åˆ›å»ºæ–‡ä»¶ | ä¸€é”®ç”Ÿæˆ | 90% |
| æ‰‹åŠ¨æ›´æ–°æ–‡æ¡£ | è‡ªåŠ¨åŒæ­¥ | 95% |
| æ‰‹åŠ¨ç¼–å†™æµ‹è¯• | è‡ªåŠ¨ç”Ÿæˆç¤ºä¾‹ | 80% |
| æ‰‹åŠ¨é…ç½®ç¯å¢ƒ | ä¸€é”®éƒ¨ç½² | 85% |
| æ‰‹åŠ¨ä»£ç å®¡æŸ¥ | è‡ªåŠ¨åŒ–æ£€æŸ¥ | 70% |
| æ‰‹åŠ¨é¡¹ç›®åˆå§‹åŒ– | å¿«é€Ÿå¯åŠ¨ | 95% |
| æ‰‹åŠ¨æ¨¡å—ç”Ÿæˆ | æ ‡å‡†åŒ–ç”Ÿæˆ | 87% |
| æ‰‹åŠ¨APIå¼€å‘ | æ¨¡æ¿åŒ–ç”Ÿæˆ | 87% |

---

## ğŸ› ï¸ è‡ªåŠ¨åŒ–å·¥å…·é“¾æ¶æ„

### æ ¸å¿ƒå·¥å…·é“¾

```
FastAPIé¡¹ç›®è‡ªåŠ¨åŒ–å¼€å‘å·¥å…·é“¾
â”œâ”€â”€ é¡¹ç›®åˆå§‹åŒ–å·¥å…·
â”‚   â”œâ”€â”€ create_project.py          # ä¸€é”®åˆ›å»ºé¡¹ç›®ï¼ˆå¿«é€Ÿå¯åŠ¨ï¼‰
â”‚   â”œâ”€â”€ setup_environment.py       # ç¯å¢ƒé…ç½®
â”‚   â””â”€â”€ init_structure.py         # é¡¹ç›®ç»“æ„åˆå§‹åŒ–
â”œâ”€â”€ åŠŸèƒ½å¼€å‘å·¥å…·
â”‚   â”œâ”€â”€ new_feature.py            # ä¸€é”®ç”Ÿæˆæ–°åŠŸèƒ½
â”‚   â”œâ”€â”€ gen_example.py            # ç”ŸæˆåŠŸèƒ½ç¤ºä¾‹
â”‚   â””â”€â”€ gen_api.py                # ç”ŸæˆAPIæ¥å£ï¼ˆæ ‡å‡†åŒ–ï¼‰
â”œâ”€â”€ æ¨¡å—ç”Ÿæˆå·¥å…·
â”‚   â”œâ”€â”€ gen_module.py             # ç”Ÿæˆä¸šåŠ¡æ¨¡å—
â”‚   â”œâ”€â”€ gen_model.py              # ç”Ÿæˆæ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ gen_service.py            # ç”Ÿæˆä¸šåŠ¡æœåŠ¡
â”œâ”€â”€ æ–‡ä»¶ç³»ç»Ÿå·¥å…·
â”‚   â”œâ”€â”€ file_manager.py           # æ–‡ä»¶æ“ä½œç®¡ç†
â”‚   â”œâ”€â”€ structure_generator.py    # é¡¹ç›®ç»“æ„ç”Ÿæˆ
â”‚   â””â”€â”€ template_manager.py       # æ¨¡æ¿ç®¡ç†
â”œâ”€â”€ æ–‡æ¡£åŒæ­¥å·¥å…·
â”‚   â”œâ”€â”€ sync_docs.py              # æ–‡æ¡£è‡ªåŠ¨åŒæ­¥
â”‚   â”œâ”€â”€ update_status.py          # çŠ¶æ€æ›´æ–°
â”‚   â””â”€â”€ gen_api_docs.py           # APIæ–‡æ¡£ç”Ÿæˆ
â”œâ”€â”€ è´¨é‡ä¿è¯å·¥å…·
â”‚   â”œâ”€â”€ auto_lint.py              # è‡ªåŠ¨ä»£ç æ£€æŸ¥
â”‚   â”œâ”€â”€ auto_test.py              # è‡ªåŠ¨æµ‹è¯•è¿è¡Œ
â”‚   â””â”€â”€ quality_gate.py           # è´¨é‡é—¨ç¦
â””â”€â”€ å‘½ä»¤è¡Œå·¥å…·
    â”œâ”€â”€ cli_main.py               # å‘½ä»¤è¡Œä¸»å…¥å£
    â”œâ”€â”€ commands/                 # å‘½ä»¤å®ç°
    â””â”€â”€ utils/                    # å·¥å…·å‡½æ•°
```

---

## âš¡ ä¸€é”®å¼€å‘æµç¨‹

### æ–°åŠŸèƒ½å¼€å‘å®Œæ•´æµç¨‹

```bash
# 1. ä¸€é”®ç”Ÿæˆæ–°åŠŸèƒ½ï¼ˆåŒ…å«æ‰€æœ‰æ–‡ä»¶ï¼‰
uv run python scripts/new_feature.py \
  --module 01_app_management \
  --type create \
  --feature "æ–°å¢å•ä¸ªåº”ç”¨" \
  --auto-generate-all

# 2. è‡ªåŠ¨è¡¥å……ä¸šåŠ¡é€»è¾‘ï¼ˆAIè¾…åŠ©ï¼‰
uv run python scripts/auto_implement.py \
  --feature "æ–°å¢å•ä¸ªåº”ç”¨" \
  --ai-assist

# 3. è‡ªåŠ¨éªŒè¯å’Œæµ‹è¯•
uv run python scripts/auto_validate.py \
  --feature "æ–°å¢å•ä¸ªåº”ç”¨"

# 4. è‡ªåŠ¨åŒæ­¥æ–‡æ¡£
make sync-docs

# 5. è‡ªåŠ¨æäº¤ä»£ç 
make auto-commit --message "feat: æ–°å¢å•ä¸ªåº”ç”¨åŠŸèƒ½"
```

### æ‰¹é‡åŠŸèƒ½å¼€å‘

```bash
# æ‰¹é‡ç”Ÿæˆå¤šä¸ªåŠŸèƒ½
uv run python scripts/batch_generate.py \
  --features "æ–°å¢å•ä¸ªåº”ç”¨,æ‰¹é‡æ–°å¢åº”ç”¨,æŸ¥è¯¢åº”ç”¨åˆ—è¡¨,åˆ†é¡µæŸ¥è¯¢åº”ç”¨" \
  --module 01_app_management

# æ‰¹é‡éªŒè¯æ‰€æœ‰åŠŸèƒ½
make batch-validate

# æ‰¹é‡åŒæ­¥æ–‡æ¡£
make batch-sync-docs
```

---

## ğŸ”§ è‡ªåŠ¨åŒ–å·¥å…·è¯¦ç»†è§„èŒƒ

### 1. é¡¹ç›®åˆå§‹åŒ–è‡ªåŠ¨åŒ–

#### ä¸€é”®åˆ›å»ºé¡¹ç›®
```bash
# åˆ›å»ºæ–°çš„FastAPIé¡¹ç›®
uv run python scripts/create_project.py \
  --name "my_fastapi_project" \
  --template "standard" \
  --database "postgresql" \
  --auth "jwt" \
  --auto-setup
```

#### ç¯å¢ƒé…ç½®è‡ªåŠ¨åŒ–
```bash
# è‡ªåŠ¨é…ç½®å¼€å‘ç¯å¢ƒ
uv run python scripts/setup_environment.py \
  --python-version "3.11" \
  --dependencies "fastapi,uvicorn,sqlalchemy" \
  --dev-tools "black,ruff,mypy" \
  --auto-install
```

### 2. åŠŸèƒ½å¼€å‘è‡ªåŠ¨åŒ–

#### æ–°åŠŸèƒ½ä¸€é”®ç”Ÿæˆ
```python
# scripts/new_feature.py
class FeatureGenerator:
    def generate_feature(self, module: str, feature_type: str, feature_name: str):
        """ä¸€é”®ç”Ÿæˆæ–°åŠŸèƒ½"""
        # 1. è‡ªåŠ¨ç”ŸæˆåŠŸèƒ½ç¤ºä¾‹è„šæœ¬
        self.generate_example_script(module, feature_type, feature_name)
        
        # 2. è‡ªåŠ¨ç”ŸæˆAPIæ¥å£
        self.generate_api_endpoint(module, feature_type, feature_name)
        
        # 3. è‡ªåŠ¨ç”Ÿæˆæ•°æ®æ¨¡å‹
        self.generate_data_model(module, feature_name)
        
        # 4. è‡ªåŠ¨ç”Ÿæˆä¸šåŠ¡æœåŠ¡
        self.generate_service(module, feature_name)
        
        # 5. è‡ªåŠ¨æ›´æ–°æ–‡æ¡£
        self.update_documentation(module, feature_name)
        
        # 6. è‡ªåŠ¨æ›´æ–°TODO.md
        self.update_todo(module, feature_name)
        
        # 7. è‡ªåŠ¨ç”Ÿæˆæµ‹è¯•æ•°æ®
        self.generate_test_data(module, feature_name)
        
        print(f"âœ… åŠŸèƒ½ '{feature_name}' å·²è‡ªåŠ¨ç”Ÿæˆå®Œæˆï¼")
```

#### åŠŸèƒ½ç¤ºä¾‹è‡ªåŠ¨ç”Ÿæˆ
```python
# scripts/gen_example.py
class ExampleGenerator:
    def generate_example(self, feature_name: str, feature_type: str):
        """è‡ªåŠ¨ç”ŸæˆåŠŸèƒ½ç¤ºä¾‹"""
        template = self.load_template(feature_type)
        
        # è‡ªåŠ¨å¡«å……æ¨¡æ¿
        example_code = template.format(
            feature_name=feature_name,
            class_name=self.to_class_name(feature_name),
            method_name=self.to_method_name(feature_name),
            api_endpoint=self.generate_api_endpoint(feature_name),
            test_data=self.generate_test_data(feature_name)
        )
        
        # è‡ªåŠ¨ä¿å­˜æ–‡ä»¶
        self.save_example_file(feature_name, example_code)
        
        return example_code
```

### 3. æ•°æ®ç®¡ç†è‡ªåŠ¨åŒ–

#### ç»Ÿä¸€æ•°æ®å·¥å‚
```python
# examples/data_factory.py
class AppFactory:
    """åº”ç”¨æ•°æ®å·¥å‚"""
    
    @staticmethod
    def create_app(**kwargs):
        """åˆ›å»ºåº”ç”¨æ•°æ®"""
        default_data = {
            "app_name": f"test_app_{int(time.time())}",
            "description": "è‡ªåŠ¨åŒ–æµ‹è¯•åº”ç”¨",
            "signature_algorithm": "SHA256",
            "ip_whitelist": ["127.0.0.1"],
            "rate_limit": 1000,
            "timestamp_window": 300
        }
        default_data.update(kwargs)
        return default_data
    
    @staticmethod
    def create_batch_apps(count: int = 5):
        """æ‰¹é‡åˆ›å»ºåº”ç”¨æ•°æ®"""
        return [AppFactory.create_app() for _ in range(count)]

class DataCleaner:
    """æ•°æ®æ¸…ç†å·¥å…·"""
    
    @staticmethod
    def cleanup_apps(app_ids: List[str]):
        """æ¸…ç†åº”ç”¨æ•°æ®"""
        for app_id in app_ids:
            try:
                requests.delete(f"{BASE_URL}/api/v1/apps/{app_id}")
                print(f"âœ… å·²æ¸…ç†åº”ç”¨: {app_id}")
            except Exception as e:
                print(f"âš ï¸ æ¸…ç†åº”ç”¨å¤±è´¥: {app_id}, é”™è¯¯: {e}")
```

### 4. æ–‡æ¡£åŒæ­¥è‡ªåŠ¨åŒ–

#### è‡ªåŠ¨æ–‡æ¡£åŒæ­¥
```python
# scripts/sync_docs.py
class DocSynchronizer:
    def sync_all_docs(self):
        """åŒæ­¥æ‰€æœ‰æ–‡æ¡£"""
        # 1. æ‰«ææ‰€æœ‰ç¤ºä¾‹è„šæœ¬
        examples = self.scan_examples()
        
        # 2. æ‰«ææ‰€æœ‰APIæ¥å£
        apis = self.scan_apis()
        
        # 3. æ›´æ–°åŠŸèƒ½æ¸…å•
        self.update_function_list(examples)
        
        # 4. æ›´æ–°APIæ–‡æ¡£
        self.update_api_docs(apis)
        
        # 5. æ›´æ–°é¡¹ç›®çŠ¶æ€
        self.update_project_status(examples, apis)
        
        # 6. æ›´æ–°TODO.md
        self.update_todo(examples)
        
        # 7. æ›´æ–°README.md
        self.update_readme(examples, apis)
        
        print("âœ… æ‰€æœ‰æ–‡æ¡£å·²è‡ªåŠ¨åŒæ­¥å®Œæˆï¼")
    
    def scan_examples(self):
        """æ‰«æç¤ºä¾‹è„šæœ¬"""
        examples = []
        for root, dirs, files in os.walk("examples"):
            for file in files:
                if file.endswith(".py") and not file.startswith("__"):
                    examples.append({
                        "file": file,
                        "path": os.path.join(root, file),
                        "module": root.split("/")[-1],
                        "feature": self.extract_feature_name(file)
                    })
        return examples
```

### 5. è´¨é‡ä¿è¯è‡ªåŠ¨åŒ–

#### è‡ªåŠ¨ä»£ç æ£€æŸ¥
```python
# scripts/auto_lint.py
class AutoLinter:
    def run_all_checks(self):
        """è¿è¡Œæ‰€æœ‰ä»£ç æ£€æŸ¥"""
        checks = [
            ("ä»£ç æ ¼å¼åŒ–", "black ."),
            ("ä»£ç æ£€æŸ¥", "ruff check ."),
            ("ç±»å‹æ£€æŸ¥", "mypy ."),
            ("å®‰å…¨æ£€æŸ¥", "bandit -r ."),
            ("å¤æ‚åº¦æ£€æŸ¥", "radon cc .")
        ]
        
        results = []
        for name, command in checks:
            try:
                result = subprocess.run(command, shell=True, capture_output=True, text=True)
                if result.returncode == 0:
                    print(f"âœ… {name}: é€šè¿‡")
                    results.append(True)
                else:
                    print(f"âŒ {name}: å¤±è´¥")
                    print(result.stdout)
                    results.append(False)
            except Exception as e:
                print(f"âŒ {name}: å¼‚å¸¸ - {e}")
                results.append(False)
        
        return all(results)
```

---

## ğŸ“‹ FastAPIç»Ÿä¸€å¼€å‘è§„èŒƒ

### 1. é¡¹ç›®ç»“æ„è§„èŒƒ

```
fastapi_project/
â”œâ”€â”€ src/                        # æºä»£ç 
â”‚   â””â”€â”€ project_name/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ main.py             # åº”ç”¨å…¥å£
â”‚       â”œâ”€â”€ config.py           # é…ç½®ç®¡ç†
â”‚       â”œâ”€â”€ api/                # APIè·¯ç”±
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”œâ”€â”€ v1/             # APIç‰ˆæœ¬
â”‚       â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”‚   â”œâ”€â”€ apps.py     # åº”ç”¨ç®¡ç†API
â”‚       â”‚   â”‚   â”œâ”€â”€ users.py    # ç”¨æˆ·ç®¡ç†API
â”‚       â”‚   â”‚   â””â”€â”€ auth.py     # è®¤è¯API
â”‚       â”‚   â””â”€â”€ deps.py         # ä¾èµ–æ³¨å…¥
â”‚       â”œâ”€â”€ models/             # æ•°æ®æ¨¡å‹
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”œâ”€â”€ base.py         # åŸºç¡€æ¨¡å‹
â”‚       â”‚   â”œâ”€â”€ app.py          # åº”ç”¨æ¨¡å‹
â”‚       â”‚   â””â”€â”€ user.py         # ç”¨æˆ·æ¨¡å‹
â”‚       â”œâ”€â”€ services/           # ä¸šåŠ¡é€»è¾‘
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”œâ”€â”€ app_service.py  # åº”ç”¨æœåŠ¡
â”‚       â”‚   â””â”€â”€ user_service.py # ç”¨æˆ·æœåŠ¡
â”‚       â”œâ”€â”€ middleware/         # ä¸­é—´ä»¶
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”œâ”€â”€ auth.py         # è®¤è¯ä¸­é—´ä»¶
â”‚       â”‚   â””â”€â”€ logging.py      # æ—¥å¿—ä¸­é—´ä»¶
â”‚       â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•°
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”œâ”€â”€ crypto.py       # åŠ å¯†å·¥å…·
â”‚       â”‚   â””â”€â”€ validators.py   # éªŒè¯å·¥å…·
â”‚       â””â”€â”€ core/               # æ ¸å¿ƒåŠŸèƒ½
â”‚           â”œâ”€â”€ __init__.py
â”‚           â”œâ”€â”€ database.py     # æ•°æ®åº“é…ç½®
â”‚           â””â”€â”€ security.py     # å®‰å…¨é…ç½®
â”œâ”€â”€ examples/                   # åŠŸèƒ½ç¤ºä¾‹
â”‚   â”œâ”€â”€ 01_app_management/      # åº”ç”¨ç®¡ç†åŠŸèƒ½
â”‚   â”œâ”€â”€ 02_user_management/     # ç”¨æˆ·ç®¡ç†åŠŸèƒ½
â”‚   â”œâ”€â”€ data_factory.py         # æ•°æ®å·¥å‚
â”‚   â”œâ”€â”€ data_cleaner.py         # æ•°æ®æ¸…ç†
â”‚   â””â”€â”€ run_all.py             # è¿è¡Œæ‰€æœ‰ç¤ºä¾‹
â”œâ”€â”€ scripts/                    # è‡ªåŠ¨åŒ–è„šæœ¬
â”‚   â”œâ”€â”€ new_feature.py         # æ–°åŠŸèƒ½ç”Ÿæˆ
â”‚   â”œâ”€â”€ sync_docs.py           # æ–‡æ¡£åŒæ­¥
â”‚   â”œâ”€â”€ auto_lint.py           # è‡ªåŠ¨æ£€æŸ¥
â”‚   â””â”€â”€ setup_project.py       # é¡¹ç›®è®¾ç½®
â”œâ”€â”€ docs/                       # æ–‡æ¡£
â”‚   â”œâ”€â”€ README.md              # é¡¹ç›®è¯´æ˜
â”‚   â”œâ”€â”€ APIæ–‡æ¡£.md             # APIæ–‡æ¡£
â”‚   â”œâ”€â”€ å¼€å‘è§„èŒƒ.md            # å¼€å‘è§„èŒƒ
â”‚   â”œâ”€â”€ åŠŸèƒ½æ¸…å•.md            # åŠŸèƒ½æ¸…å•
â”‚   â””â”€â”€ TODO.md                # å¼€å‘ä»»åŠ¡
â”œâ”€â”€ tests/                      # ä¼ ç»Ÿæµ‹è¯•ï¼ˆå¯é€‰ï¼‰
â”œâ”€â”€ pyproject.toml             # é¡¹ç›®é…ç½®
â”œâ”€â”€ Makefile                   # å¼€å‘å·¥å…·
â”œâ”€â”€ .env.example               # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ .gitignore                 # Gitå¿½ç•¥æ–‡ä»¶
â””â”€â”€ README.md                  # é¡¹ç›®ä»‹ç»
```

### 2. APIè®¾è®¡è§„èŒƒ

#### ç»Ÿä¸€å“åº”æ ¼å¼
```python
# src/project_name/core/responses.py
from typing import Any, Optional, Dict
from pydantic import BaseModel

class APIResponse(BaseModel):
    """ç»Ÿä¸€APIå“åº”æ ¼å¼"""
    success: bool
    data: Optional[Any] = None
    message: Optional[str] = None
    error: Optional[Dict] = None
    timestamp: str
    request_id: Optional[str] = None

class PaginatedResponse(BaseModel):
    """åˆ†é¡µå“åº”æ ¼å¼"""
    items: list
    total: int
    page: int
    size: int
    pages: int
    has_next: bool
    has_prev: bool
```

#### ç»Ÿä¸€é”™è¯¯å¤„ç†
```python
# src/project_name/core/exceptions.py
from fastapi import HTTPException
from typing import Any, Dict

class APIException(HTTPException):
    """ç»Ÿä¸€APIå¼‚å¸¸"""
    def __init__(
        self,
        status_code: int,
        error_code: str,
        message: str,
        details: Optional[Dict[str, Any]] = None
    ):
        super().__init__(status_code=status_code)
        self.error_code = error_code
        self.message = message
        self.details = details or {}

# é¢„å®šä¹‰å¼‚å¸¸
class ValidationError(APIException):
    def __init__(self, message: str, details: Optional[Dict] = None):
        super().__init__(400, "VALIDATION_ERROR", message, details)

class NotFoundError(APIException):
    def __init__(self, resource: str, resource_id: str):
        super().__init__(404, "NOT_FOUND", f"{resource} not found: {resource_id}")

class PermissionDeniedError(APIException):
    def __init__(self, message: str = "Permission denied"):
        super().__init__(403, "PERMISSION_DENIED", message)
```

### 3. æ•°æ®æ¨¡å‹è§„èŒƒ

#### åŸºç¡€æ¨¡å‹
```python
# src/project_name/models/base.py
from sqlalchemy import Column, Integer, DateTime, Boolean
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.sql import func
from pydantic import BaseModel, Field
from typing import Optional
from datetime import datetime

Base = declarative_base()

class BaseModelMixin:
    """SQLAlchemyåŸºç¡€æ¨¡å‹æ··å…¥"""
    id = Column(Integer, primary_key=True, index=True)
    created_at = Column(DateTime(timezone=True), server_default=func.now())
    updated_at = Column(DateTime(timezone=True), onupdate=func.now())
    is_deleted = Column(Boolean, default=False)

class BasePydanticModel(BaseModel):
    """PydanticåŸºç¡€æ¨¡å‹"""
    id: Optional[int] = None
    created_at: Optional[datetime] = None
    updated_at: Optional[datetime] = None
    
    class Config:
        from_attributes = True
        json_encoders = {
            datetime: lambda v: v.isoformat()
        }
```

#### åº”ç”¨æ¨¡å‹ç¤ºä¾‹
```python
# src/project_name/models/app.py
from sqlalchemy import Column, String, Text, JSON, Integer
from .base import Base, BaseModelMixin
from pydantic import BaseModel, Field
from typing import List, Optional

class App(Base, BaseModelMixin):
    """åº”ç”¨æ¨¡å‹"""
    __tablename__ = "apps"
    
    app_id = Column(String(50), unique=True, index=True, nullable=False)
    app_name = Column(String(100), nullable=False)
    description = Column(Text)
    app_secret = Column(String(255), nullable=False)
    signature_algorithm = Column(String(20), default="SHA256")
    ip_whitelist = Column(JSON, default=list)
    rate_limit = Column(Integer, default=1000)
    timestamp_window = Column(Integer, default=300)
    status = Column(String(20), default="active")

class AppCreate(BaseModel):
    """åˆ›å»ºåº”ç”¨è¯·æ±‚æ¨¡å‹"""
    app_name: str = Field(..., min_length=1, max_length=100)
    description: Optional[str] = None
    signature_algorithm: str = Field(default="SHA256", regex="^(MD5|SHA256|HMAC-SHA256)$")
    ip_whitelist: List[str] = Field(default_factory=list)
    rate_limit: int = Field(default=1000, ge=1)
    timestamp_window: int = Field(default=300, ge=60, le=3600)

class AppUpdate(BaseModel):
    """æ›´æ–°åº”ç”¨è¯·æ±‚æ¨¡å‹"""
    app_name: Optional[str] = Field(None, min_length=1, max_length=100)
    description: Optional[str] = None
    signature_algorithm: Optional[str] = Field(None